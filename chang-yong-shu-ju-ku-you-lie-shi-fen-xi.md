# 常用数据库优劣势分析

#### MySQL（关系型数据库）

优势：

1. 精确查找优秀。
2. in-place update，相对ES来说的。
3. OLTP

劣势：

1. 非列式存储，对OLAP、分析不够友好。
2. 索引不能太多。
3. schema固定，DBA帮助帮助新增字段。

#### MongoDB（文档数据库）

优势：

1. 无schema。支持动态新增column。
2. in-place update，相对ES来说的
3. OLTP

劣势：

1. 索引不能太多。

#### ElasticSearch（搜索引擎）

多维查询，秒级返回的索引数据库。作为其他数据库的二级索引。

优势：

1. \*\*多维度查询性能好。\*\*每个column都有索引。有列式存储和倒排索引。

2. 维护方便，上手方便。

3. 中等规模数据的OLAP查询。

schema free。不需要定义表结构。

4. \*\*适合作为其他数据库的（库外）二级索引。（一致性要求要放低。最终一致性即可。）\*\*

弱势：

1. 不支持SQL，只能写专用的DSL语言并组织一个JSON报文。

2. 不支持JOIN。\*\*只能做基于一个大宽表的OLAP。\*\*（在ES外JOIN好并写入ES。）

3. 更新操作不够高效（先标记删除再新增）。所以用户画像的更新（比如新增了一个标签），打算避开使用ES。

4. 继续上面问题。大宽表问题，新增标签成本太大（Hive需要改表结构，ES需要删除再新增，ES估计也是有schema改动的）。

5. \*\*不能支持用户画像的动态新增column。\*\*



### SQL on Hadoop

#### Hive（Hadoop/MapReduce）

优势：

1. 支持大数据量，一般是离线处理。

2. 支持JOIN。

3. OLAP（慢）

4. \*\*结合Spark，适合做数据清洗。存储一些中间表。\*\*Hive on MongoDB/Hbase这种方案需要了解下，好多细节不了解。TODO。



劣势：

1. 底层是HDFS，修改需要覆盖写。

2. schema固定。也就是说先要定义好表结构。（用户画像场景，新增一个标签意味着需要更新schema。）

3. Hive无法提供ad-hoc查询，耗时长。

4. Impala虽然能提供BI。但是大量用户同时使用也是有瓶颈的。



#### Spark SQL（Spark）

1. 兼容Hive。
2. 
#### Hbase（KV数据库）

优势：

1. \*\*支持动态增加column。\*\*作为用户画像的存储是有优势的，新增一个标签就方便了！

2. KV数据库，速度快。

3. 集群扩展方便，可以一直水平扩展。

4. OLTP

劣势：

1. \*\*底层是HDFS。还得部署一个Hadoop集群。\*\*

2. KV数据库，不支持丰富的查询。\*\*（加速查询，把数据dump到ES中去。）\*\*

#### 





